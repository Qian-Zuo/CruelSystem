图数据库

# 什么是图数据库
把业务问题抽象建模成[点/边/属性]的关联关系, 保存到图数据库中
相比关系型数据库: 避免了使用上多次join的操作, schema限制少
相比kv型数据库: 同样不支持图操作(dfs, bfs等), 对出入度大的节点支持差

# 什么场景下使用图数据库
数据之间存在较多层次的关联关系, 可以被抽象为 实体 & 联系
1. 用户和数据之间的关联关系 (关注/点赞/转发等等)
2. 业务逻辑之间的关联关系 (微服务之间依赖关系)
3. 分析场景(代码关联, 类似github上代码跳转)
4. 树状关系: 文章转发, reddit评论区盖楼

# 查询语言
1. cypher
2. gremlin: 受到主流系统的支持较多, 比cypher表达能力更丰富

# 图数据库架构
1. 查询引擎: 解析查询输入语句, 生成/优化查询plan, 和存储引擎层进行交互, 执行查询计划
2. 存储引擎: 保存点/边数据

## 如何存储图:
- 保存 <节点id, 出边/入边type+属性, 对端节点id> 以及 <节点id -> 节点属性>的映射
- 每个每个点的不同类型的边分别保存, 例如用户的关注/点赞关系分别作为两个独立的partition保存
- 每个<点, 边类型>作为key, 映射到所有的边, 这些边可以按照一定的数据结构进行存储, 例如 in-mem/on-disk 的B+树
  
## 如何检索点的边
- 根据<点, 边类型>找到相关的B+树, 然后在树上进行检索, 如果是按照时间戳排序, 则在O(N)的时间复杂度下可以找到一级关联关系
- 如果是多级关系检索, 则需要进行上述过程进行检索, 这个过程由查询引擎和存储引擎共同完成, 对用户透明

