## 速率控制算法，1011
- 令牌桶，Amazon和Stripe使用，预先定义容量，定期配额，每次请求消耗一个令牌
- 没有足够的令牌，就会丢弃请求，配置：桶大小，填充速率，不同接口，用不同的桶
- 基于IP的限制，每个IP需要一个桶，也可以用一个全局桶，来保障真个系统的性能稳定
- 优点，算法易于实现，消耗内存少，令牌桶允许系统有峰值
- 缺点，桶的大小，和填充速率，不容易配置
- 漏油桶，队列实现，固定队列大小，处理请求速率恒定
- 缺点，队列大小固定，队列满的时候，丢弃最近的请求，桶的大小和溢出速率不容易调优
- 固定窗口计数器，比如一秒钟最多三个请求，每秒钟一个桶，无法处理峰值
- 滑动窗口日志，优点，处理能力强，缺点，消耗大量内存
- 滑动窗口计数器，综合上述两者

## 深入设计
- 创建限制规则
- 存储限制规则
- 分布式锁，只能主写，强一致性如何保证写操作频繁的操作？分片？
