# CH6 - 设计一个键值数据库，1015

## 数据复制
- 可配置 N 个副本，顺时针方向上的N个后续节点
- 使用虚拟节点，可能分布在少于 N 个物理机器上
- 可以选择不同的 N 个物理机器

## 一致性
- N 副本数，W 写法定人数，W 读法定人数
- W + R > N，强一致性
- R = 1, W = N，快速读
- W = 1，R = N，快速写
- W + R <= N，不能保证强一致性

## 冲突解决，向量时钟
- [X: 1] -> [X: 2] --> [X: 2, Y: 1] ----> [X:2, Y:1, Z:1]
                   \-> [X: 2, Z: 1] --/
				   
## 故障检测
- 每个节点维护成员列表
- 每个节点周期性更新心跳
- 每个节点发送心跳给一组随机节点
- 其他节点收到心跳，就会更新成员列表
- 节点的心跳超时没更新，则会从成员列表删除
- TODO-Gossip

## 故障处理
- 带暗示的交接
