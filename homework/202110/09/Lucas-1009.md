## CH4 - 设计速率限制器，1009

## 需求
- 防止 DoS 攻击
- 节省成本，优先级高的服务享受更多的计算资源
- 按次收费的接口或服务，需要速率限制器
- 防止系统过载
- 精准限制超量请求
- 低延迟，不能影响已有服务
- 内存使用量低
- 异常处理，超量时如何处理
- 高容错

## 用例
- 每个用户每秒只能发送两次请求
- 每个IP一天只能创建10个新账号
- 每个设备每周只能兑换五次优惠券


## 概要设计
- Client  -----------------------------> Rate Limiter --------------> API Server
        \--<-- 429 Too many requests---/

## 算法
- 令牌桶，Amazon和Stripe使用，预先定义容量，定期配额，每次请求消耗一个令牌
- 漏油桶
- 固定窗口计数器
- 滑动窗口日志
- 滑动窗口计数器
