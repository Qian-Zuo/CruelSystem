# 从零用户到百万用户的扩容
- Alex Xu Chapter 1

## 单节点服务器配置
- 客户端：浏览器，移动应用
- 域名服务器把域名解析成 IP
- 客户端访问单点服务器
- 应用服务器对数据库进行操作

## 数据库的选择
- 非关系型数据库场景
- 非结构化数据，数据之间没有关联
- 数据只需要序列化和反序列化
- 需要存储大量数据

## 系统的扩展
- 垂直扩展，提高服务器的硬件配置
- 水平扩展，增加服务器数量

## 负载均衡
- 客户端通过负载均衡访问多个应用服务器
- 应用服务器访问多个数据库

## 数据库副本
- 读写分离，提高性能
- 可靠性
- 可用性

## 缓存
- 缓存有数据，立即返回
- 缓存不存在，加载数据库到缓存，再返回

## CDN
- 将静态内容推送到离客户更近的服务器
- 考虑成本，只适用高频内容
- 适当的过期策略
- 能处理CDN失效

## TODO
- 无状态服务
- 多数据中心，支持灾备
- 消息队列
- 日志，性能指标，自动化

## 数据库扩容
- 垂直扩容，提高服务器性能
- 水平扩容，增加服务器数量
- 怎么不是数据库表扩容？
- 数据库分片，每个分片模式相同，数据不同
- 节点故障是，考虑重新分片
- 明星问题
- 大表的 Join，和反规范化

## 小结
- 应用层无状态
- 每层冗余
- 尽可能多的缓存
- 多个数据中心
- 静态内容推送 CDN
- 通过分片扩容
- 分离每层成单独的服务
- 监测系统和自动化管理
